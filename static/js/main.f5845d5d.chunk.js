(this.webpackJsonpPlaylistObservatory=this.webpackJsonpPlaylistObservatory||[]).push([[0],{133:function(e,t,a){},134:function(e,t,a){},155:function(e,t,a){e.exports=a(287)},160:function(e,t,a){},161:function(e,t,a){},164:function(e,t,a){},166:function(e,t,a){},269:function(e,t,a){},287:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(40),s=a.n(i),l=(a(160),a(59),a(12)),c=a(13),o=a(15),u=a(14),p=a(8),d=(a(161),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(p.j,{id:"LoginPage"},r.a.createElement("h1",null,"Playlist Obsevatory"),r.a.createElement("p",{className:"Subtitle"},"This is an app maps the tracks of a playlist into 2D space based on the properties of the track"),r.a.createElement("hr",null),r.a.createElement("p",null,"You will ",r.a.createElement("b",null,"need 2 things")," to use this app: A ",r.a.createElement("b",null,"Spotify Premium account")," and ",r.a.createElement("b",null,"one playlist")," you would like to edit"),r.a.createElement(p.a,{onClick:this.props.login},"Start"),r.a.createElement("div",{id:"Creds"},r.a.createElement("p",null,"Made by Goh Sato -- ",r.a.createElement("a",{href:"https://github.com/Gohsato/PlaylistObservatory",target:"_blank",rel:"noopener noreferrer"},"code"))))}}]),a}(r.a.Component)),m=(a(164),a(16)),h=a(11),f=a.n(h),v=a(23),y=a(144),g=new(a.n(y).a),b={_userId:void 0,getUserId:function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this._userId){e.next=4;break}return e.next=3,g.getMe();case 3:this._userId=e.sent.id;case 4:return e.abrupt("return",this._userId);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),appendAnalysis:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.map((function(e){return e.id})),e.next=3,g.getAudioFeaturesForTracks(a);case 3:return n=(n=e.sent).audio_features,t.forEach((function(e,t){e.analysis=n[t]})),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getPlaylist:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getPlaylist(t);case 2:return a=e.sent,n=a.tracks.items.map((function(e){return e.track})),e.next=6,this.appendAnalysis(n);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),_getSeeds:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n,r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(e){for(var t=e.length;t>0;){var a=Math.floor(Math.random()*t),n=e[--t];e[t]=e[a],e[a]=n}return e},e.next=3,g.getPlaylist(t);case 3:if(0!==(n=e.sent.tracks).total){e.next=9;break}return r={limit:5,time_range:"medium_term"},e.next=8,g.getMyTopTracks(r);case 8:n=e.sent;case 9:return i=n.items.map((function(e){return e.track?e.track.id:e.id})),a(i),e.abrupt("return",i.slice(0,5));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getRecommendations:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n,r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getSeeds(t);case 2:return a=e.sent,n={limit:10,seed_tracks:a,min_popularity:50},e.next=6,g.getRecommendations(n);case 6:return r=e.sent,e.next=9,this.appendAnalysis(r.tracks);case 9:return i=e.sent,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),getGraphData:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPlaylist(t);case 2:return e.t0=e.sent,e.next=5,this.getRecommendations(t);case 5:return e.t1=e.sent,e.abrupt("return",{playlist:e.t0,recommended:e.t1});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),addTrackToPlaylist:function(){var e=Object(v.a)(f.a.mark((function e(t,a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.addTracksToPlaylist(a,[t]);case 2:return e.next=4,this.getPlaylist(a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),removeTrackFromPlaylist:function(){var e=Object(v.a)(f.a.mark((function e(t,a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.removeTracksFromPlaylist(a,[t]);case 2:return e.next=4,this.getPlaylist(a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),getUserPlaylists:function(){var e=Object(v.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getUserPlaylists();case 2:return t=e.sent,e.next=5,this.getUserId();case 5:return a=e.sent,t.items=t.items.filter((function(e){return e.owner.id===a})),e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},k=a(29),E="energy",x="danceability",O="acousticness",j="valence";function w(e){this.name=e,this.dataFunction=function(t){return 100*t.analysis[e]}}var C=a(145);a(97);function S(e){return r.a.createElement(p.c,{className:"graph-settings-card"},r.a.createElement(p.d,null,r.a.createElement(p.g,null,e.fieldName),r.a.createElement(p.i,null,r.a.createElement(p.r,null,e.options.map((function(t){return r.a.createElement(p.a,{key:t,onClick:function(){e.onBtnClick(t)},active:e.current===t},t)}))))))}function P(e){return r.a.createElement("div",{className:"icon"},r.a.createElement("p",null,e.title,":"),r.a.createElement("div",{className:"dot"},r.a.createElement("svg",{viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("circle",{cx:"50%",cy:"50%",r:"2",fill:e.color}))))}var T=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={xAxis:n.props.dataFields.xAxis,yAxis:n.props.dataFields.yAxis},n.onRadioBtnClick=n.onRadioBtnClick.bind(Object(m.a)(n)),n}return Object(c.a)(a,[{key:"onRadioBtnClick",value:function(e,t){var a=this;this.setState(Object(C.a)({},t,new w(e)),(function(){return a.props.onChange(a.state)}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"ControlPanel"},r.a.createElement(p.h,null,r.a.createElement(P,{title:"Recommended Track",color:"tomato"}),r.a.createElement(P,{title:"Playlist Track",color:"#455A64"}),r.a.createElement(S,{fieldName:"X Axis",current:this.state.xAxis.name,onBtnClick:function(t){return e.onRadioBtnClick(t,"xAxis")},options:[E,x,j,O]}),r.a.createElement(S,{fieldName:"Y Axis",current:this.state.yAxis.name,onBtnClick:function(t){return e.onRadioBtnClick(t,"yAxis")},options:[E,x,j,O]})))}}]),a}(n.Component),D=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={popoverOpen:!1},e.toggle=e.toggle.bind(Object(m.a)(e)),e}return Object(c.a)(a,[{key:"toggle",value:function(){this.setState({popoverOpen:!this.state.popoverOpen})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(p.a,{id:"Popover1",onClick:this.toggle},this.props.title),r.a.createElement(p.o,{placement:"bottom",isOpen:this.state.popoverOpen,target:"Popover1",toggle:this.toggle},r.a.createElement(p.q,null,"Graph Settings"),r.a.createElement(p.p,null,this.props.children)))}}]),a}(r.a.Component);function R(e){return r.a.createElement("div",{id:"CornerButtons"},r.a.createElement(D,{title:r.a.createElement(k.e,null)},r.a.createElement(T,{dataFields:e.dataFields,onChange:e.setDataFields,updateRecommendations:e.updateRecommendations,graphRef:e.forwardedRef})),r.a.createElement("div",null,r.a.createElement(p.a,{onClick:e.updateRecommendations},r.a.createElement(k.d,null))),e.forwardedRef.current?r.a.createElement("div",null,r.a.createElement(p.a,{onClick:e.forwardedRef.current.setSelected},r.a.createElement(k.b,null))):null)}var F=a(296),_=a(299),A=a(295),N=a(301),I=a(298),M=a(302),G=a(297),B=a(303);a(166);function z(e,t){var a=(z.canvas||(z.canvas=document.createElement("canvas"))).getContext("2d");return a.font=t,a.measureText(e).width}var L=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={hidden:"hidden"},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.delay=setTimeout((function(){e.setState({hidden:""})}),550)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.delay)}},{key:"render",value:function(){var e=this.props,t=e.x,a=e.y,n=this.props.datum,i=n.album.images[0].url,s=n.name,l=n.artists[0].name,c=0;return n._x>40&&(t-=15,c=Math.max(z(s,"bold 18px arial"),z(l,"bold 15px arial"))+3+100),r.a.createElement("foreignObject",{x:t,y:a,width:"400",height:"400",transform:"translate(-"+c+")"},r.a.createElement("div",{id:"TrackHoverDetail",className:this.state.hidden},r.a.createElement("img",{src:i,style:{height:100},alt:"album art"}),r.a.createElement("div",null,r.a.createElement("h1",null,s),r.a.createElement("h2",null,l))))}}]),a}(r.a.Component),U=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={externalMutations:void 0,chartHeight:void 0,chartWidth:void 0},e.setSelected=e.setSelected.bind(Object(m.a)(e)),e.resize=e.resize.bind(Object(m.a)(e)),e}return Object(c.a)(a,[{key:"createEventHandler",value:function(e,t){return{childName:["playlist","recommended"],target:["data"],eventKey:"all",mutation:function(t){return e&&t.datum.id===e?{style:Object.assign({},t.style,{fill:"#44ac00"})}:{style:void 0}},callback:t}}},{key:"removeMutation",value:function(){this.setState({externalMutations:void 0})}},{key:"setSelected",value:function(e){this.setState({externalMutations:[this.createEventHandler(e,this.removeMutation.bind(this))]})}},{key:"resize",value:function(){var e=document.getElementById("Graph").getBoundingClientRect();this.setState({chartHeight:e.height,chartWidth:e.width})}},{key:"componentDidMount",value:function(){this.resize(),window.addEventListener("resize",this.resize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"renderGraph",value:function(){var e=this;return r.a.createElement(F.a,{externalEventMutations:this.state.externalMutations,theme:_.a.material,domain:{x:[0,100],y:[0,100]},containerComponent:r.a.createElement(A.a,{zoomDomain:this.props.startDomain}),width:this.state.chartWidth,height:this.state.chartHeight,events:[{childName:["playlist","recommended"],target:"data",eventHandlers:{onClick:function(t,a){return[e.createEventHandler(a.datum.id,e.props.onPointClick(a))]}}}],padding:{top:15,bottom:20,left:20,right:15}},r.a.createElement(N.a,{label:this.props.dataFields.xAxis.name,axisLabelComponent:r.a.createElement(I.a,null),tickLabelComponent:r.a.createElement(I.a,{dy:-25}),tickComponent:r.a.createElement(M.a,{active:!1})}),r.a.createElement(N.a,{label:this.props.dataFields.yAxis.name,axisLabelComponent:r.a.createElement(I.a,null),tickLabelComponent:r.a.createElement(I.a,{dx:33}),tickComponent:r.a.createElement(M.a,{active:!1}),dependentAxis:!0}),r.a.createElement(G.a,{name:"playlist",size:15,data:this.props.graphData.playlistTracks,x:this.props.dataFields.xAxis.dataFunction,y:this.props.dataFields.yAxis.dataFunction,labels:function(e){return""},labelComponent:r.a.createElement(B.a,{flyoutComponent:r.a.createElement(L,null)})}),r.a.createElement(G.a,{name:"recommended",size:10,data:this.props.graphData.recommendTracks,x:this.props.dataFields.xAxis.dataFunction,y:this.props.dataFields.yAxis.dataFunction,labels:function(e){return""},labelComponent:r.a.createElement(B.a,{flyoutComponent:r.a.createElement(L,null)}),style:{data:{fill:"tomato"}}}))}},{key:"render",value:function(){return r.a.createElement("div",{id:"Graph",className:"fillheight"},this.props.graphData?this.renderGraph():r.a.createElement("p",{className:"fillheight"},"playlist loading"))}}]),a}(n.Component),H=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={dataFields:{xAxis:new w(x),yAxis:new w(E)}},e.setDataFields=e.setDataFields.bind(Object(m.a)(e)),e}return Object(c.a)(a,[{key:"setDataFields",value:function(e){this.setState({dataFields:e})}},{key:"render",value:function(){return r.a.createElement("div",{className:"fillheight",id:"Graph"},r.a.createElement(R,{dataFields:this.state.dataFields,setDataFields:this.setDataFields,updateRecommendations:this.props.updateRecommendations,forwardedRef:this.props.forwardedRef}),r.a.createElement(U,{dataFields:this.state.dataFields,ref:this.props.forwardedRef,graphData:this.props.graphData,onPointClick:this.props.pointClick,startDomain:{x:[0,100],y:[0,100]}}))}}]),a}(r.a.Component),W=(a(133),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={popoverOpen:!1},e.toggle=e.toggle.bind(Object(m.a)(e)),e}return Object(c.a)(a,[{key:"toggle",value:function(){this.setState({popoverOpen:!this.state.popoverOpen})}},{key:"render",value:function(){var e=this,t=this.props.track.name,a=this.props.track.artists[0].name;return r.a.createElement("div",{className:"PlaylistEntry"},r.a.createElement("p",null,this.props.i+1,"."),r.a.createElement("div",{className:"PlaylistEntryTitle"},r.a.createElement("h1",{className:"ellipse"},t),r.a.createElement("h2",{className:"ellipse"},a)),r.a.createElement("div",{className:"navBar",id:"Popover2"+this.props.i,onClick:this.toggle}),r.a.createElement(p.o,{target:"Popover2"+this.props.i,placement:"bottom",isOpen:this.state.popoverOpen,toggle:this.toggle},r.a.createElement(p.p,null,r.a.createElement(p.b,{vertical:!0},r.a.createElement(p.a,{color:"danger",onClick:function(){return e.props.removeSong(e.props.track)}},"Delete Song"),r.a.createElement(p.a,{onClick:function(){return e.props.pointSelect(e.props.track)}},"Select Song")))))}}]),a}(r.a.Component)),V=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this;if(!this.props.graphData)return r.a.createElement("div",null,"no playlist");var t=this.props.graphData.playlistTracks;return r.a.createElement("div",{id:"PlaylistView"},r.a.createElement("i",null,"tracks:"),r.a.createElement(p.c,{id:"PlaylistTracks"},r.a.createElement(p.d,null,t.map((function(t,a){return r.a.createElement(W,{key:t.name+a,track:t,removeSong:e.props.removeSong,pointSelect:e.props.pointSelect,i:a})})),0===t.length?r.a.createElement("p",null,"no tracks in this playlist... yet"):null)))}}]),a}(r.a.Component),q=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t=this.props.selected.id.startsWith("recommended"),a=this.props.selected.datum?this.props.selected.datum:this.props.selected,n=a.album.images[0].url,i=a.name;return r.a.createElement("div",{id:"TrackViewer"},r.a.createElement("div",{id:"Track"},r.a.createElement("h5",null,t?"Recommendation:":"Playlist Track:"),r.a.createElement("div",null,r.a.createElement("img",{src:n,style:{height:150},alt:"album art"})),r.a.createElement("h3",null,i),t?r.a.createElement(p.a,{className:"OptionButton",onClick:function(){return e.props.addTrack(a)}},"add track"):r.a.createElement(p.a,{className:"OptionButton",onClick:function(){return e.props.removeTrack(a)}},"delete")),r.a.createElement(p.a,{id:"ExitButton",onClick:function(){return e.props.exit()}},"exit"))}}]),a}(r.a.Component);function J(e){var t;return t=e.selected?r.a.createElement(q,{exit:e.pointSelect,removeTrack:e.removeTrack,addTrack:e.addTrack,selected:e.selected}):r.a.createElement(V,{graphData:e.graphData,removeSong:e.removeTrack,pointSelect:e.pointSelect}),r.a.createElement("div",{id:"LeftBar"},t)}a(269);var Y=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={modal:!1},n.toggle=n.toggle.bind(Object(m.a)(n)),n}return Object(c.a)(a,[{key:"toggle",value:function(){this.setState({modal:!this.state.modal})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(p.a,{onClick:this.toggle},this.props.buttonLabel),r.a.createElement(p.k,{isOpen:this.state.modal,toggle:this.toggle,className:this.props.className},r.a.createElement(p.n,{toggle:this.toggle},"A Quick Tour"),r.a.createElement(p.l,null,r.a.createElement("p",null,"Click the ",r.a.createElement(k.e,null)," icon to alter the graph axis and to view the legend"),r.a.createElement("p",null,"The ",r.a.createElement(k.d,null)," button generates more recommendations"),r.a.createElement("p",null,"The ",r.a.createElement(k.b,null)," buttons centers the graph."),r.a.createElement("p",null,"Click on the dots to add/remove tracks from the playlist.")),r.a.createElement(p.m,null,r.a.createElement("p",{id:"Creds"},"Made by Goh Sato ",r.a.createElement("a",{href:"https://github.com/Gohsato/PlaylistObservatory",target:"_blank",rel:"noopener noreferrer"},"Github Repo")))))}}]),a}(r.a.Component),K=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={graphData:void 0,selected:void 0},e.graphRef=r.a.createRef(),e.addTrack=e.addTrack.bind(Object(m.a)(e)),e.removeTrack=e.removeTrack.bind(Object(m.a)(e)),e.pointClick=e.pointClick.bind(Object(m.a)(e)),e.pointSelect=e.pointSelect.bind(Object(m.a)(e)),e.updateRecommendations=e.updateRecommendations.bind(Object(m.a)(e)),e}return Object(c.a)(a,[{key:"setGraphData",value:function(e,t){this.setState({graphData:{playlistTracks:e,recommendTracks:t}})}},{key:"componentDidMount",value:function(){var e=this;b.getGraphData(this.props.playlist.id).then((function(t){e.setGraphData(t.playlist,t.recommended)})).catch((function(e){console.log(e)}))}},{key:"updateRecommendations",value:function(){var e=this;b.getRecommendations(this.props.playlist.id).then((function(t){var a=e.state.graphData.playlistTracks;e.setState({graphData:{recommendTracks:t,playlistTracks:a}}),e.pointSelect()}))}},{key:"addTrack",value:function(e){var t=this;b.addTrackToPlaylist(e.uri,this.props.playlist.id).then((function(a){var n=t.state.graphData.recommendTracks.filter((function(t){return t.id!==e.id}));t.setGraphData(a,n),t.pointSelect()}))}},{key:"removeTrack",value:function(e){var t=this;b.removeTrackFromPlaylist(e.uri,this.props.playlist.id).then((function(e){var a=t.state.graphData.recommendTracks;t.setGraphData(e,a),t.pointSelect()}))}},{key:"pointClick",value:function(e){this.setState({selected:e})}},{key:"pointSelect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this.setState({selected:e}),this.graphRef.current){var t=e?e.id:void 0;this.graphRef.current.setSelected(t)}}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.r,{id:"Header",noGutters:!0},r.a.createElement(p.a,{id:"ExitPlaylist",onClick:this.props.exitPlaylist},r.a.createElement(k.a,null)," exit playlist"),r.a.createElement("div",{id:"PlaylistViewTitle"},r.a.createElement("i",null,"playlist:")," ",r.a.createElement("b",{className:"tomatoFont"},this.props.playlist.name)),r.a.createElement(Y,{buttonLabel:"?"})),r.a.createElement(p.r,{className:"align-items-center body",noGutters:!0},r.a.createElement(p.h,{xs:"3",className:"fillheight"},r.a.createElement(J,{selected:this.state.selected,pointSelect:this.pointSelect,removeTrack:this.removeTrack,addTrack:this.addTrack,playlist:this.props.playlist,graphData:this.state.graphData})),r.a.createElement(p.h,{xs:"9",className:"fillheight"},r.a.createElement(H,{forwardedRef:this.graphRef,graphData:this.state.graphData,pointClick:this.pointClick,updateRecommendations:this.updateRecommendations}))))}}]),a}(n.Component);a(134);function Q(){return r.a.createElement("div",{className:"noImage"},r.a.createElement(k.c,null),r.a.createElement("p",null,"no image"))}function X(e){var t=e.playlist,a=t.images[0]?r.a.createElement(p.e,{top:!0,width:"100%",src:t.images[0].url,height:150,alt:"playlistImage"}):r.a.createElement(Q,null),n=t.tracks.total;return r.a.createElement(p.c,{className:"PlaylistOption"},a,r.a.createElement(p.d,null,r.a.createElement(p.g,{className:"width",title:t.name},t.name),r.a.createElement(p.f,null,n," tracks"),r.a.createElement(p.a,{onClick:function(){e.setPlaylist(t)}},"select")))}var Z=function(e){var t;return e.listOfplaylists&&(t=e.listOfplaylists.map((function(t){return r.a.createElement(X,{key:t.id,playlist:t,setPlaylist:e.setPlaylist})}))),r.a.createElement(p.j,{id:"PlaylistList"},r.a.createElement("h1",null,"Select a Playlist"),r.a.createElement("p",null,"Choose a playlist to visualize and edit"),r.a.createElement("div",{id:"Center"},r.a.createElement("div",{id:"PlaylistDisplay"},t),e.listOfplaylists?null:r.a.createElement("p",null,"you need to create a playlist on spotify first")))},$=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={listOfplaylists:void 0,playlist:void 0},e.setPlaylist=e.setPlaylist.bind(Object(m.a)(e)),e.exitPlaylist=e.exitPlaylist.bind(Object(m.a)(e)),e}return Object(c.a)(a,[{key:"setPlaylist",value:function(e){this.setState({playlist:e})}},{key:"exitPlaylist",value:function(){var e=this;this.setPlaylist(void 0),b.getUserPlaylists().then((function(t){e.setState({listOfplaylists:t.items})}))}},{key:"componentDidMount",value:function(){var e=this;b.getUserPlaylists().then((function(t){e.setState({listOfplaylists:t.items})}))}},{key:"render",value:function(){return this.state.playlist?r.a.createElement(K,{playlist:this.state.playlist,exitPlaylist:this.exitPlaylist}):r.a.createElement(Z,{listOfplaylists:this.state.listOfplaylists,setPlaylist:this.setPlaylist})}}]),a}(r.a.Component),ee=a(154),te=a.n(ee),ae="user-read-private user-read-email playlist-modify-private playlist-read-private user-top-read",ne="spotify-access-token",re="spotify-refresh-token",ie="spotify-code-verifier",se="spotify-state",le="spotify-token-expires-at";function ce(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*a.length));return t}function oe(e){var t=(new TextEncoder).encode(e);return window.crypto.subtle.digest("SHA-256",t)}function ue(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function pe(){return de.apply(this,arguments)}function de(){return(de=Object(v.a)(f.a.mark((function e(){var t,a,n,r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ce(115),e.next=3,oe(t);case 3:a=e.sent,n=ue(a),r=ce(8),sessionStorage.setItem(ie,t),sessionStorage.setItem(se,r),i="https://accounts.spotify.com/authorize"+"?response_type=code&client_id=".concat("652193cf2bd7437a8dee2528d853149f","&")+"redirect_uri=".concat("https://gohsato.github.io/PlaylistObservatory/","&scope=").concat(ae,"&state=").concat(r,"&")+"code_challenge=".concat(n,"&code_challenge_method=S256"),window.open(i,"_self");case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(){return(me=Object(v.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===sessionStorage.getItem(ne)){e.next=15;break}return console.log("found access token"),g.setAccessToken(sessionStorage.getItem(ne)),e.prev=3,e.next=6,g.getMe();case 6:e.next=14;break;case 8:return e.prev=8,e.t0=e.catch(3),console.log(e.t0),e.next=13,ve();case 13:return e.abrupt("return",e.sent);case 14:return e.abrupt("return",!0);case 15:if(!(t=new URLSearchParams(window.location.search.slice(1))).has("state")||t.get("state")===sessionStorage.getItem(se)){e.next=19;break}return console.log("login failed"),e.abrupt("return",!1);case 19:if(!t.has("code")){e.next=25;break}return console.log("getting token"),a={client_id:"652193cf2bd7437a8dee2528d853149f",grant_type:"authorization_code",code:t.get("code"),redirect_uri:"https://gohsato.github.io/PlaylistObservatory/",code_verifier:sessionStorage.getItem(ie)},e.abrupt("return",he(a));case 25:t.has("error")&&console.log("login failed");case 26:return e.abrupt("return",!1);case 27:case"end":return e.stop()}}),e,null,[[3,8]])})))).apply(this,arguments)}function he(e){return fe.apply(this,arguments)}function fe(){return(fe=Object(v.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new URLSearchParams(t),e.prev=1,e.next=4,te.a.post("https://accounts.spotify.com/api/token",a,{headers:{"Content-Type":"application/x-www-form-urlencoded;"}});case 4:return n=e.sent,sessionStorage.setItem(ne,n.data.access_token),sessionStorage.setItem(le,(new Date).getTime()+1e3*n.data.expires_in),sessionStorage.setItem(re,n.data.refresh_token),g.setAccessToken(sessionStorage.getItem(ne)),setTimeout(ve,1e3*(n.data.expires_in-60)),e.abrupt("return",!0);case 13:return e.prev=13,e.t0=e.catch(1),console.log("token request failed"),console.log(e.t0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function ve(){return ye.apply(this,arguments)}function ye(){return(ye=Object(v.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("refresh token"),t={client_id:"652193cf2bd7437a8dee2528d853149f",grant_type:"refresh_token",refresh_token:sessionStorage.getItem(re)},e.abrupt("return",he(t));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ge=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={loggedIn:!1},function(){return me.apply(this,arguments)}().then((function(t){t&&e.setState({loggedIn:!0})})),e}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},this.state.loggedIn?r.a.createElement($,null):r.a.createElement(d,{login:pe}))}}]),a}(n.Component);s.a.render(r.a.createElement(ge,null),document.getElementById("root"))},97:function(e,t,a){}},[[155,1,2]]]);
//# sourceMappingURL=main.f5845d5d.chunk.js.map